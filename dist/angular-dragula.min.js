!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).angularDragula=e()}}(function(){return function i(a,u,l){function c(n,e){if(!u[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(s)return s(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[n]={exports:{}};a[n][0].call(o.exports,function(e){return c(a[n][1][e]||e)},o,o.exports,i,a,u,l)}return u[n].exports}for(var s="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,n,t){"use strict";var r=e("./service"),o=e("./directive");n.exports=function(e){var n=e.module("dragula",["ng"]);return n.factory("dragulaService",r(e)),n.directive("dragula",o(e)),"dragula"}},{"./directive":2,"./service":15}],2:[function(e,n,t){"use strict";var c=e("dragula");n.exports=function(d){return["dragulaService",function(l){return{restrict:"A",scope:{dragulaScope:"=",dragulaModel:"=",dragulaController:"="},link:function(f,e,n){var r,o=f.dragulaScope||f.$parent,t=e[0],i=f.$eval(n.dragula),a=document.getElementById("page_frame"),u=l.find(o,i);u?(r=u.drake).containers.push(t):(r=c({containers:[t],moves:function(e,n,t,r){return!d.element(e).hasClass("is-ungrouped")},accepts:function(e,n,t,r){return!(d.element(n).hasClass("has-location")&&d.element(e).hasClass("dragula-root")||d.element(n).hasClass("has-location")&&d.element(e).hasClass("dragula-branch")||d.element(n).hasClass("dragula-root-container")&&d.element(e).hasClass("dragula-leaf")||d.element(n).hasClass("has-child")&&d.element(e).hasClass("dragula-leaf")||d.element(n).hasClass("is-ungrouped")&&d.element(e).hasClass("dragula-root")||d.element(n).hasClass("is-ungrouped")&&d.element(e).hasClass("dragula-branch"))},revertOnSpill:!0}),l.add(o,i,r)),d.element(document).on("mousemove",function(e){if(r.dragging){var n=a.offsetTop,t=a.offsetTop+a.offsetHeight;t-e.pageY<120?a.scrollTop+=5:n+e.pageY<120&&(a.scrollTop-=1)}}),f.$watch("dragulaModel",function(e,n){if(e){if(r.models){var t=n?r.models.indexOf(n):-1;0<=t?r.models.splice(t,1,e):r.models.push(e)}else r.models=[e];l.handleModels(o,r)}}),f.$watch("dragulaController",function(e,n){e&&r.on("drop",function(e,n,t){var r,o,i,a={};if(d.element(e).attr("id")&&(r=d.element(e).attr("id")),o=d.element(e).hasClass("dragula-leaf")?"location":"group",r){var u,l,c;if("group"===o)for(c=0;c<f.dragulaController.orgGroupsService.groups.length;c++)f.dragulaController.orgGroupsService.groups[c].id===parseInt(r)&&(u=f.dragulaController.orgGroupsService.groups[c]);if("location"===o)for(c=0;c<f.dragulaController.orgGroupsService.locations.length;c++)f.dragulaController.orgGroupsService.locations[c].id===parseInt(r)&&(l=f.dragulaController.orgGroupsService.locations[c]);var s=d.element(n).children();for(c=0;c<s.length;c++)s[c].id&&(a[c]=s[c].id);if(u){if(d.element(n).hasClass("dragula-root-container")){for(u.parent_id=null,c=0;c<d.element(n).children().length;c++)d.element(d.element(n).children()[c]).hasClass("dragula-branch")&&d.element(d.element(n).children()[c]).remove();f.dragulaController.updateGroups(u,a)}d.element(n).hasClass("dragula-branch-container")&&((i=d.element(n).parent().parent()).attr("id")&&(u.parent_id=parseInt(i.attr("id"))),f.dragulaController.updateGroups(u,a))}l&&d.element(n).hasClass("dragula-branch-container")&&((i=d.element(n).parent().parent()).attr("id")?l.org_group_id=parseInt(i.attr("id")):l.org_group_id=null,f.dragulaController.updateLocation(l))}})})}}}]}},{dragula:10}],3:[function(e,n,t){n.exports=function(e,n){return Array.prototype.slice.call(e,n)}},{}],4:[function(e,n,t){"use strict";var r=e("ticky");n.exports=function(e,n,t){e&&r(function(){e.apply(t||null,n||[])})}},{ticky:12}],5:[function(e,n,t){"use strict";var u=e("atoa"),l=e("./debounce");n.exports=function(o,e){var i=e||{},a={};return void 0===o&&(o={}),o.on=function(e,n){return a[e]?a[e].push(n):a[e]=[n],o},o.once=function(e,n){return n._once=!0,o.on(e,n),o},o.off=function(e,n){var t=arguments.length;if(1===t)delete a[e];else if(0===t)a={};else{var r=a[e];if(!r)return o;r.splice(r.indexOf(n),1)}return o},o.emit=function(){var e=u(arguments);return o.emitterSnapshot(e.shift()).apply(this,e)},o.emitterSnapshot=function(r){var e=(a[r]||[]).slice(0);return function(){var n=u(arguments),t=this||o;if("error"===r&&!1!==i.throws&&!e.length)throw 1===n.length?n[0]:n;return e.forEach(function(e){i.async?l(e,n,t):e.apply(t,n),e._once&&o.off(r,e)}),o}},o}},{"./debounce":4,atoa:3}],6:[function(t,r,e){(function(c){"use strict";var o=t("custom-event"),i=t("./eventmap"),a=c.document,e=function(e,n,t,r){return e.addEventListener(n,t,r)},n=function(e,n,t,r){return e.removeEventListener(n,t,r)},s=[];function f(e,n,t){var r=function(e,n,t){var r,o;for(r=0;r<s.length;r++)if((o=s[r]).element===e&&o.type===n&&o.fn===t)return r}(e,n,t);if(r){var o=s[r].wrapper;return s.splice(r,1),o}}c.addEventListener||(e=function(e,n,t){return e.attachEvent("on"+n,(r=e,o=n,i=t,a=f(r,o,i)||(u=r,l=i,function(e){var n=e||c.event;n.target=n.target||n.srcElement,n.preventDefault=n.preventDefault||function(){n.returnValue=!1},n.stopPropagation=n.stopPropagation||function(){n.cancelBubble=!0},n.which=n.which||n.keyCode,l.call(u,n)}),s.push({wrapper:a,element:r,type:o,fn:i}),a));var r,o,i,a,u,l},n=function(e,n,t){var r=f(e,n,t);if(r)return e.detachEvent("on"+n,r)}),r.exports={add:e,remove:n,fabricate:function(e,n,t){var r=-1===i.indexOf(n)?new o(n,{detail:t}):function(){var e;a.createEvent?(e=a.createEvent("Event")).initEvent(n,!0,!0):a.createEventObject&&(e=a.createEventObject());return e}();e.dispatchEvent?e.dispatchEvent(r):e.fireEvent("on"+n,r)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":7,"custom-event":8}],7:[function(e,o,n){(function(e){"use strict";var n=[],t="",r=/^on/;for(t in e)r.test(t)&&n.push(t.slice(2));o.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t,n){(function(e){var n=e.CustomEvent;t.exports=function(){try{var e=new n("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}return!1}()?n:"function"==typeof document.createEvent?function(e,n){var t=document.createEvent("CustomEvent");return n?t.initCustomEvent(e,n.bubbles,n.cancelable,n.detail):t.initCustomEvent(e,!1,!1,void 0),t}:function(e,n){var t=document.createEventObject();return t.type=e,n?(t.bubbles=Boolean(n.bubbles),t.cancelable=Boolean(n.cancelable),t.detail=n.detail):(t.bubbles=!1,t.cancelable=!1,t.detail=void 0),t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,n,t){"use strict";var r={},o="(?:^|\\s)",i="(?:\\s|$)";function a(e){var n=r[e];return n?n.lastIndex=0:r[e]=n=new RegExp(o+e+i,"g"),n}n.exports={add:function(e,n){var t=e.className;t.length?a(n).test(t)||(e.className+=" "+n):e.className=n},rm:function(e,n){e.className=e.className.replace(a(n)," ").trim()}}},{}],10:[function(e,n,t){(function(o){"use strict";var D=e("contra/emitter"),P=e("crossvent"),G=e("./classes"),j=document,F=j.documentElement;function R(e,n,t,r){o.navigator.pointerEnabled?P[n](e,{mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"}[t],r):o.navigator.msPointerEnabled?P[n](e,{mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"}[t],r):(P[n](e,{mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"}[t],r),P[n](e,t,r))}function q(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var n=e.button;return void 0!==n?1&n?1:2&n?3:4&n?2:0:void 0}function U(e,n){return void 0!==o[n]?o[n]:F.clientHeight?F[e]:j.body[e]}function H(e,n,t){var r,o=e||{},i=o.className;return o.className+=" gu-hide",r=j.elementFromPoint(n,t),o.className=i,r}function K(){return!1}function z(){return!0}function V(e){return e.width||e.right-e.left}function J(e){return e.height||e.bottom-e.top}function Q(e){return e.parentNode===j?null:e.parentNode}function W(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||function e(n){if(!n)return!1;if("false"===n.contentEditable)return!1;if("true"===n.contentEditable)return!0;return e(Q(n))}(e)}function Z(n){return n.nextElementSibling||function(){var e=n;for(;e=e.nextSibling,e&&1!==e.nodeType;);return e}()}function ee(e,n){var t,r=(t=n).targetTouches&&t.targetTouches.length?t.targetTouches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,o={pageX:"clientX",pageY:"clientY"};return e in o&&!(e in r)&&o[e]in r&&(e=o[e]),r[e]}n.exports=function(e,n){var p,m,v,g,h,a,u,y,w,b,t;1===arguments.length&&!1===Array.isArray(e)&&(n=e,e=[]);var l,T=null,C=n||{};void 0===C.moves&&(C.moves=z),void 0===C.accepts&&(C.accepts=z),void 0===C.invalid&&(C.invalid=function(){return!1}),void 0===C.containers&&(C.containers=e||[]),void 0===C.isContainer&&(C.isContainer=K),void 0===C.copy&&(C.copy=!1),void 0===C.copySortSource&&(C.copySortSource=!1),void 0===C.revertOnSpill&&(C.revertOnSpill=!1),void 0===C.removeOnSpill&&(C.removeOnSpill=!1),void 0===C.direction&&(C.direction="vertical"),void 0===C.ignoreInputTextSelection&&(C.ignoreInputTextSelection=!0),void 0===C.mirrorContainer&&(C.mirrorContainer=j.body);var E=D({containers:C.containers,start:function(e){var n=x(e);n&&S(n)},end:O,cancel:A,remove:k,destroy:function(){r(!0),I({})},canMove:function(e){return!!x(e)},dragging:!1});return!0===C.removeOnSpill&&E.on("over",function(e){G.rm(e,"gu-hide")}).on("out",function(e){E.dragging&&G.add(e,"gu-hide")}),r(),E;function c(e){return-1!==E.containers.indexOf(e)||C.isContainer(e)}function r(e){var n=e?"remove":"add";R(F,n,"mousedown",i),R(F,n,"mouseup",I)}function s(e){R(F,e?"remove":"add","mousemove",d)}function f(e){var n=e?"remove":"add";P[n](F,"selectstart",o),P[n](F,"click",o)}function o(e){l&&e.preventDefault()}function i(e){if(a=e.clientX,u=e.clientY,1===q(e)&&!e.metaKey&&!e.ctrlKey){var n=e.target,t=x(n);t&&(l=t,s(),"mousedown"===e.type&&(W(n)?n.focus():e.preventDefault()))}}function d(e){if(l)if(0!==q(e)){if(void 0===e.clientX||e.clientX!==a||void 0===e.clientY||e.clientY!==u){if(C.ignoreInputTextSelection){var n=ee("clientX",e),t=ee("clientY",e);if(W(j.elementFromPoint(n,t)))return}var r=l;s(!0),f(),O(),S(r);var o,i={left:(o=v.getBoundingClientRect()).left+U("scrollLeft","pageXOffset"),top:o.top+U("scrollTop","pageYOffset")};g=ee("pageX",e)-i.left,h=ee("pageY",e)-i.top,G.add(b||v,"gu-transit"),function(){if(!p){var e=v.getBoundingClientRect();(p=v.cloneNode(!0)).style.width=V(e)+"px",p.style.height=J(e)+"px",G.rm(p,"gu-transit"),G.add(p,"gu-mirror"),C.mirrorContainer.appendChild(p),R(F,"add","mousemove",X),G.add(C.mirrorContainer,"gu-unselectable"),E.emit("cloned",p,v,"mirror")}}(),X(e)}}else I({})}function x(e){if(!(E.dragging&&p||c(e))){for(var n=e;Q(e)&&!1===c(Q(e));){if(C.invalid(e,n))return;if(!(e=Q(e)))return}var t=Q(e);if(t&&!C.invalid(e,n)&&C.moves(e,t,n,Z(e)))return{item:e,source:t}}}function S(e){var n,t;n=e.item,t=e.source,("boolean"==typeof C.copy?C.copy:C.copy(n,t))&&(b=e.item.cloneNode(!0),E.emit("cloned",b,e.item,"copy")),m=e.source,v=e.item,y=w=Z(e.item),E.dragging=!0,E.emit("drag",v,m)}function O(){if(E.dragging){var e=b||v;N(e,Q(e))}}function _(){s(!(l=!1)),f(!0)}function I(e){if(_(),E.dragging){var n=b||v,t=ee("clientX",e),r=ee("clientY",e),o=B(H(p,t,r),t,r);o&&(b&&C.copySortSource||!b||o!==m)?N(n,o):C.removeOnSpill?k():A()}}function N(e,n){var t=Q(e);b&&C.copySortSource&&n===m&&t.removeChild(v),Y(n)?E.emit("cancel",e,m,m):E.emit("drop",e,n,m,w),L()}function k(){if(E.dragging){var e=b||v,n=Q(e);n&&n.removeChild(e),E.emit(b?"cancel":"remove",e,n,m),L()}}function A(e){if(E.dragging){var n=0<arguments.length?e:C.revertOnSpill,t=b||v,r=Q(t),o=Y(r);!1===o&&n&&(b?r&&r.removeChild(b):m.insertBefore(t,y)),o||n?E.emit("cancel",t,m,m):E.emit("drop",t,r,m,w),L()}}function L(){var e=b||v;_(),p&&(G.rm(C.mirrorContainer,"gu-unselectable"),R(F,"remove","mousemove",X),Q(p).removeChild(p),p=null),e&&G.rm(e,"gu-transit"),t&&clearTimeout(t),E.dragging=!1,T&&E.emit("out",e,T,m),E.emit("dragend",e),m=v=b=y=w=t=T=null}function Y(e,n){var t;return t=void 0!==n?n:p?w:Z(b||v),e===m&&t===y}function B(t,r,o){for(var i=t;i&&!e();)i=Q(i);return i;function e(){if(!1===c(i))return!1;var e=M(i,t),n=$(i,e,r,o);return!!Y(i,n)||C.accepts(v,i,m,n)}}function X(e){if(p){e.preventDefault();var n=ee("clientX",e),t=ee("clientY",e),r=n-g,o=t-h;p.style.left=r+"px",p.style.top=o+"px";var i=b||v,a=H(p,n,t),u=B(a,n,t),l=null!==u&&u!==T;(l||null===u)&&(T&&d("out"),T=u,l&&d("over"));var c=Q(i);if(u!==m||!b||C.copySortSource){var s,f=M(u,a);if(null!==f)s=$(u,f,n,t);else{if(!0!==C.revertOnSpill||b)return void(b&&c&&c.removeChild(i));s=y,u=m}(null===s&&l||s!==i&&s!==Z(i))&&(w=s,u.insertBefore(i,s),E.emit("shadow",i,u,m))}else c&&c.removeChild(i)}function d(e){E.emit(e,i,T,m)}}function M(e,n){for(var t=n;t!==e&&Q(t)!==e;)t=Q(t);return t===F?null:t}function $(o,n,i,a){var e,u="horizontal"===C.direction;return n!==o?(e=n.getBoundingClientRect(),t(u?i>e.left+V(e)/2:a>e.top+J(e)/2)):function(){var e,n,t,r=o.children.length;for(e=0;e<r;e++){if(n=o.children[e],t=n.getBoundingClientRect(),u&&t.left+t.width/2>i)return n;if(!u&&t.top+t.height/2>a)return n}return null}();function t(e){return e?Z(n):n}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./classes":9,"contra/emitter":5,crossvent:6}],11:[function(e,n,t){var r,o,i=n.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function l(n){if(r===setTimeout)return setTimeout(n,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(e){try{return r.call(null,n,0)}catch(e){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(e){o=u}}();var c,s=[],f=!1,d=-1;function p(){f&&c&&(f=!1,c.length?s=c.concat(s):d=-1,s.length&&m())}function m(){if(!f){var e=l(p);f=!0;for(var n=s.length;n;){for(c=s,s=[];++d<n;)c&&c[d].run();d=-1,n=s.length}c=null,f=!1,function(n){if(o===clearTimeout)return clearTimeout(n);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{o(n)}catch(e){try{return o.call(null,n)}catch(e){return o.call(this,n)}}}(e)}}function v(e,n){this.fun=e,this.array=n}function g(){}i.nextTick=function(e){var n=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];s.push(new v(e,n)),1!==s.length||f||l(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],12:[function(e,t,n){(function(n){var e;e="function"==typeof n?function(e){n(e)}:function(e){setTimeout(e,0)},t.exports=e}).call(this,e("timers").setImmediate)},{timers:13}],13:[function(l,e,c){(function(e,n){var r=l("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,i={},a=0;function u(e,n){this._id=e,this._clearFn=n}c.setTimeout=function(){return new u(t.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new u(t.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(e,n){clearTimeout(e._idleTimeoutId),e._idleTimeout=n},c.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},c._unrefActive=c.active=function(e){clearTimeout(e._idleTimeoutId);var n=e._idleTimeout;0<=n&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},n))},c.setImmediate="function"==typeof e?e:function(e){var n=a++,t=!(arguments.length<2)&&o.call(arguments,1);return i[n]=!0,r(function(){i[n]&&(t?e.apply(null,t):e.call(null),c.clearImmediate(n))}),n},c.clearImmediate="function"==typeof n?n:function(e){delete i[e]}}).call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":11,timers:13}],14:[function(e,n,t){"use strict";var i=e("atoa"),a=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","drop-model","remove-model"];n.exports=function(n,t,r){function o(e){return n.isElement(e)?n.element(e):e}a.forEach(function(n){t.drake.on(n,function(){var e=i(arguments).map(o);e.unshift(t.name+"."+n),r.$emit.apply(r,e)})})}},{atoa:3}],15:[function(e,n,t){"use strict";var l=e("dragula"),r="$$dragula",c=e("./replicate-events");n.exports=function(d){return[function(){return{add:a,find:u,options:function(e,n,t){var r=a(e,n,l(t));o(e,r.drake)},destroy:function(e,n){var t=i(e).bags,r=u(e,n),o=t.indexOf(r);t.splice(o,1),r.drake.destroy()},handleModels:o};function o(t,a){var u,l,c,s;a.registered||(a.on("remove",function(e,n){a.models&&(s=a.models[a.containers.indexOf(n)],t.$applyAsync(function(){s.splice(l,1),a.emit("remove-model",e,n)}))}),a.on("drag",function(e,n){l=f(u=e,n)}),a.on("drop",function(r,o,i){a.models&&(c=f(r,o),t.$applyAsync(function(){if(s=a.models[a.containers.indexOf(i)],o===i)s.splice(c,0,s.splice(l,1)[0]);else{var e=u===r,n=a.models[a.containers.indexOf(o)],t=e?s[l]:d.copy(s[l]);e&&s.splice(l,1),n.splice(c,0,t),o.removeChild(r)}a.emit("drop-model",r,o,i)}))}),a.registered=!0)}function i(e){var n=e[r];return n||(n=e[r]={bags:[]}),n}function f(e,n){return Array.prototype.indexOf.call(d.element(n).children(),e)}function a(e,n,t){var r=u(e,n);if(r)throw new Error('Bag named: "'+n+'" already exists in same angular scope.');return r={name:n,drake:t},i(e).bags.push(r),c(d,r,e),t.models&&o(e,t),r}function u(e,n){for(var t=i(e).bags,r=0;r<t.length;r++)if(t[r].name===n)return t[r]}}]}},{"./replicate-events":14,dragula:10}]},{},[1])(1)});