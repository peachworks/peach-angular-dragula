!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).angularDragula=e()}}(function(){return function i(a,l,u){function c(n,e){if(!l[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(s)return s(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var o=l[n]={exports:{}};a[n][0].call(o.exports,function(e){return c(a[n][1][e]||e)},o,o.exports,i,a,l,u)}return l[n].exports}for(var s="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,n,t){"use strict";var r=e("./service"),o=e("./directive");n.exports=function(e){var n=e.module("dragula",["ng"]);return n.factory("dragulaService",r(e)),n.directive("dragula",o(e)),"dragula"}},{"./directive":2,"./service":13}],2:[function(e,n,t){"use strict";var c=e("dragula");n.exports=function(f){return["dragulaService",function(u){return{restrict:"A",scope:{dragulaScope:"=",dragulaModel:"=",dragulaController:"="},link:function(d,e,n){var r,o=d.dragulaScope||d.$parent,t=e[0],i=d.$eval(n.dragula),a=document.getElementById("page_frame"),l=u.find(o,i);l?(r=l.drake).containers.push(t):(r=c({containers:[t],moves:function(e,n,t,r){return!f.element(e).hasClass("is-ungrouped")},accepts:function(e,n,t,r){return!(f.element(n).hasClass("has-location")&&f.element(e).hasClass("dragula-root")||f.element(n).hasClass("has-location")&&f.element(e).hasClass("dragula-branch")||f.element(n).hasClass("dragula-root-container")&&f.element(e).hasClass("dragula-leaf")||f.element(n).hasClass("has-child")&&f.element(e).hasClass("dragula-leaf")||f.element(n).hasClass("is-ungrouped")&&f.element(e).hasClass("dragula-root")||f.element(n).hasClass("is-ungrouped")&&f.element(e).hasClass("dragula-branch"))},revertOnSpill:!0}),u.add(o,i,r)),f.element(document).on("mousemove",function(e){if(r.dragging){var n=a.offsetTop,t=a.offsetTop+a.offsetHeight;t-e.pageY<120?a.scrollTop+=5:n+e.pageY<120&&(a.scrollTop-=1)}}),d.$watch("dragulaModel",function(e,n){if(e){if(r.models){var t=n?r.models.indexOf(n):-1;0<=t?r.models.splice(t,1,e):r.models.push(e)}else r.models=[e];u.handleModels(o,r)}}),d.$watch("dragulaController",function(e,n){e&&r.on("drop",function(e,n,t){var r,o,i,a={};if(f.element(e).attr("id")&&(r=f.element(e).attr("id")),o=f.element(e).hasClass("dragula-leaf")?"location":"group",r){var l,u,c;if("group"===o)for(c=0;c<d.dragulaController.orgGroupsService.groups.length;c++)d.dragulaController.orgGroupsService.groups[c].id===parseInt(r)&&(l=d.dragulaController.orgGroupsService.groups[c]);if("location"===o)for(c=0;c<d.dragulaController.orgGroupsService.locations.length;c++)d.dragulaController.orgGroupsService.locations[c].id===parseInt(r)&&(u=d.dragulaController.orgGroupsService.locations[c]);var s=f.element(n).children();for(c=0;c<s.length;c++)s[c].id&&(a[c]=s[c].id);if(l){if(f.element(n).hasClass("dragula-root-container")){for(l.parent_id=null,c=0;c<f.element(n).children().length;c++)f.element(f.element(n).children()[c]).hasClass("dragula-branch")&&f.element(f.element(n).children()[c]).remove();d.dragulaController.updateGroups(l,a)}f.element(n).hasClass("dragula-branch-container")&&((i=f.element(n).parent().parent()).attr("id")&&(l.parent_id=parseInt(i.attr("id"))),d.dragulaController.updateGroups(l,a))}u&&f.element(n).hasClass("dragula-branch-container")&&((i=f.element(n).parent().parent()).attr("id")?u.org_group_id=parseInt(i.attr("id")):u.org_group_id=null,d.dragulaController.updateLocation(u))}})})}}}]}},{dragula:10}],3:[function(e,n,t){n.exports=function(e,n){return Array.prototype.slice.call(e,n)}},{}],4:[function(e,n,t){"use strict";var r=e("ticky");n.exports=function(e,n,t){e&&r(function(){e.apply(t||null,n||[])})}},{ticky:11}],5:[function(e,n,t){"use strict";var l=e("atoa"),u=e("./debounce");n.exports=function(o,e){var i=e||{},a={};return void 0===o&&(o={}),o.on=function(e,n){return a[e]?a[e].push(n):a[e]=[n],o},o.once=function(e,n){return n._once=!0,o.on(e,n),o},o.off=function(e,n){var t=arguments.length;if(1===t)delete a[e];else if(0===t)a={};else{var r=a[e];if(!r)return o;r.splice(r.indexOf(n),1)}return o},o.emit=function(){var e=l(arguments);return o.emitterSnapshot(e.shift()).apply(this,e)},o.emitterSnapshot=function(r){var e=(a[r]||[]).slice(0);return function(){var n=l(arguments),t=this||o;if("error"===r&&!1!==i.throws&&!e.length)throw 1===n.length?n[0]:n;return e.forEach(function(e){i.async?u(e,n,t):e.apply(t,n),e._once&&o.off(r,e)}),o}},o}},{"./debounce":4,atoa:3}],6:[function(t,r,e){(function(c){"use strict";var o=t("custom-event"),i=t("./eventmap"),a=c.document,e=function(e,n,t,r){return e.addEventListener(n,t,r)},n=function(e,n,t,r){return e.removeEventListener(n,t,r)},s=[];function d(e,n,t){var r=function(e,n,t){var r,o;for(r=0;r<s.length;r++)if((o=s[r]).element===e&&o.type===n&&o.fn===t)return r}(e,n,t);if(r){var o=s[r].wrapper;return s.splice(r,1),o}}c.addEventListener||(e=function(e,n,t){return e.attachEvent("on"+n,(r=e,o=n,i=t,a=d(r,o,i)||(l=r,u=i,function(e){var n=e||c.event;n.target=n.target||n.srcElement,n.preventDefault=n.preventDefault||function(){n.returnValue=!1},n.stopPropagation=n.stopPropagation||function(){n.cancelBubble=!0},n.which=n.which||n.keyCode,u.call(l,n)}),s.push({wrapper:a,element:r,type:o,fn:i}),a));var r,o,i,a,l,u},n=function(e,n,t){var r=d(e,n,t);if(r)return e.detachEvent("on"+n,r)}),r.exports={add:e,remove:n,fabricate:function(e,n,t){var r=-1===i.indexOf(n)?new o(n,{detail:t}):function(){var e;a.createEvent?(e=a.createEvent("Event")).initEvent(n,!0,!0):a.createEventObject&&(e=a.createEventObject());return e}();e.dispatchEvent?e.dispatchEvent(r):e.fireEvent("on"+n,r)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":7,"custom-event":8}],7:[function(e,o,n){(function(e){"use strict";var n=[],t="",r=/^on/;for(t in e)r.test(t)&&n.push(t.slice(2));o.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t,n){(function(e){var n=e.CustomEvent;t.exports=function(){try{var e=new n("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}return!1}()?n:"function"==typeof document.createEvent?function(e,n){var t=document.createEvent("CustomEvent");return n?t.initCustomEvent(e,n.bubbles,n.cancelable,n.detail):t.initCustomEvent(e,!1,!1,void 0),t}:function(e,n){var t=document.createEventObject();return t.type=e,n?(t.bubbles=Boolean(n.bubbles),t.cancelable=Boolean(n.cancelable),t.detail=n.detail):(t.bubbles=!1,t.cancelable=!1,t.detail=void 0),t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,n,t){"use strict";var r={},o="(?:^|\\s)",i="(?:\\s|$)";function a(e){var n=r[e];return n?n.lastIndex=0:r[e]=n=new RegExp(o+e+i,"g"),n}n.exports={add:function(e,n){var t=e.className;t.length?a(n).test(t)||(e.className+=" "+n):e.className=n},rm:function(e,n){e.className=e.className.replace(a(n)," ").trim()}}},{}],10:[function(e,n,t){(function(o){"use strict";var P=e("contra/emitter"),G=e("crossvent"),L=e("./classes"),R=document,j=R.documentElement;function q(e,n,t,r){o.navigator.pointerEnabled?G[n](e,{mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"}[t],r):o.navigator.msPointerEnabled?G[n](e,{mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"}[t],r):(G[n](e,{mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"}[t],r),G[n](e,t,r))}function U(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var n=e.button;return void 0!==n?1&n?1:2&n?3:4&n?2:0:void 0}function F(e,n){return void 0!==o[n]?o[n]:j.clientHeight?j[e]:R.body[e]}function H(e,n,t){var r,o=e||{},i=o.className;return o.className+=" gu-hide",r=R.elementFromPoint(n,t),o.className=i,r}function K(){return!1}function z(){return!0}function V(e){return e.width||e.right-e.left}function J(e){return e.height||e.bottom-e.top}function Q(e){return e.parentNode===R?null:e.parentNode}function W(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||function e(n){if(!n)return!1;if("false"===n.contentEditable)return!1;if("true"===n.contentEditable)return!0;return e(Q(n))}(e)}function Z(n){return n.nextElementSibling||function(){var e=n;for(;e=e.nextSibling,e&&1!==e.nodeType;);return e}()}function ee(e,n){var t,r=(t=n).targetTouches&&t.targetTouches.length?t.targetTouches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,o={pageX:"clientX",pageY:"clientY"};return e in o&&!(e in r)&&o[e]in r&&(e=o[e]),r[e]}n.exports=function(e,n){var p,v,m,g,h,a,l,y,b,C,t;1===arguments.length&&!1===Array.isArray(e)&&(n=e,e=[]);var u,w=null,x=n||{};void 0===x.moves&&(x.moves=z),void 0===x.accepts&&(x.accepts=z),void 0===x.invalid&&(x.invalid=function(){return!1}),void 0===x.containers&&(x.containers=e||[]),void 0===x.isContainer&&(x.isContainer=K),void 0===x.copy&&(x.copy=!1),void 0===x.copySortSource&&(x.copySortSource=!1),void 0===x.revertOnSpill&&(x.revertOnSpill=!1),void 0===x.removeOnSpill&&(x.removeOnSpill=!1),void 0===x.direction&&(x.direction="vertical"),void 0===x.ignoreInputTextSelection&&(x.ignoreInputTextSelection=!0),void 0===x.mirrorContainer&&(x.mirrorContainer=R.body);var E=P({containers:x.containers,start:function(e){var n=S(e);n&&O(n)},end:T,cancel:X,remove:B,destroy:function(){r(!0),I({})},canMove:function(e){return!!S(e)},dragging:!1});return!0===x.removeOnSpill&&E.on("over",function(e){L.rm(e,"gu-hide")}).on("out",function(e){E.dragging&&L.add(e,"gu-hide")}),r(),E;function c(e){return-1!==E.containers.indexOf(e)||x.isContainer(e)}function r(e){var n=e?"remove":"add";q(j,n,"mousedown",i),q(j,n,"mouseup",I)}function s(e){q(j,e?"remove":"add","mousemove",f)}function d(e){var n=e?"remove":"add";G[n](j,"selectstart",o),G[n](j,"click",o)}function o(e){u&&e.preventDefault()}function i(e){if(a=e.clientX,l=e.clientY,1===U(e)&&!e.metaKey&&!e.ctrlKey){var n=e.target,t=S(n);t&&(u=t,s(),"mousedown"===e.type&&(W(n)?n.focus():e.preventDefault()))}}function f(e){if(u)if(0!==U(e)){if(void 0===e.clientX||e.clientX!==a||void 0===e.clientY||e.clientY!==l){if(x.ignoreInputTextSelection){var n=ee("clientX",e),t=ee("clientY",e);if(W(R.elementFromPoint(n,t)))return}var r=u;s(!0),d(),T(),O(r);var o,i={left:(o=m.getBoundingClientRect()).left+F("scrollLeft","pageXOffset"),top:o.top+F("scrollTop","pageYOffset")};g=ee("pageX",e)-i.left,h=ee("pageY",e)-i.top,L.add(C||m,"gu-transit"),function(){if(!p){var e=m.getBoundingClientRect();(p=m.cloneNode(!0)).style.width=V(e)+"px",p.style.height=J(e)+"px",L.rm(p,"gu-transit"),L.add(p,"gu-mirror"),x.mirrorContainer.appendChild(p),q(j,"add","mousemove",$),L.add(x.mirrorContainer,"gu-unselectable"),E.emit("cloned",p,m,"mirror")}}(),$(e)}}else I({})}function S(e){if(!(E.dragging&&p||c(e))){for(var n=e;Q(e)&&!1===c(Q(e));){if(x.invalid(e,n))return;if(!(e=Q(e)))return}var t=Q(e);if(t&&!x.invalid(e,n)&&x.moves(e,t,n,Z(e)))return{item:e,source:t}}}function O(e){var n,t;n=e.item,t=e.source,("boolean"==typeof x.copy?x.copy:x.copy(n,t))&&(C=e.item.cloneNode(!0),E.emit("cloned",C,e.item,"copy")),v=e.source,m=e.item,y=b=Z(e.item),E.dragging=!0,E.emit("drag",m,v)}function T(){if(E.dragging){var e=C||m;Y(e,Q(e))}}function N(){u=!1,s(!0),d(!0)}function I(e){if(N(),E.dragging){var n=C||m,t=ee("clientX",e),r=ee("clientY",e),o=M(H(p,t,r),t,r);o&&(C&&x.copySortSource||!C||o!==v)?Y(n,o):x.removeOnSpill?B():X()}}function Y(e,n){var t=Q(e);C&&x.copySortSource&&n===v&&t.removeChild(m),k(n)?E.emit("cancel",e,v,v):E.emit("drop",e,n,v,b),_()}function B(){if(E.dragging){var e=C||m,n=Q(e);n&&n.removeChild(e),E.emit(C?"cancel":"remove",e,n,v),_()}}function X(e){if(E.dragging){var n=0<arguments.length?e:x.revertOnSpill,t=C||m,r=Q(t),o=k(r);!1===o&&n&&(C?r&&r.removeChild(C):v.insertBefore(t,y)),o||n?E.emit("cancel",t,v,v):E.emit("drop",t,r,v,b),_()}}function _(){var e=C||m;N(),p&&(L.rm(x.mirrorContainer,"gu-unselectable"),q(j,"remove","mousemove",$),Q(p).removeChild(p),p=null),e&&L.rm(e,"gu-transit"),t&&clearTimeout(t),E.dragging=!1,w&&E.emit("out",e,w,v),E.emit("dragend",e),v=m=C=y=b=t=w=null}function k(e,n){var t;return t=void 0!==n?n:p?b:Z(C||m),e===v&&t===y}function M(t,r,o){for(var i=t;i&&!e();)i=Q(i);return i;function e(){if(!1===c(i))return!1;var e=A(i,t),n=D(i,e,r,o);return!!k(i,n)||x.accepts(m,i,v,n)}}function $(e){if(p){e.preventDefault();var n=ee("clientX",e),t=ee("clientY",e),r=n-g,o=t-h;p.style.left=r+"px",p.style.top=o+"px";var i=C||m,a=H(p,n,t),l=M(a,n,t),u=null!==l&&l!==w;(u||null===l)&&(w&&f("out"),w=l,u&&f("over"));var c=Q(i);if(l!==v||!C||x.copySortSource){var s,d=A(l,a);if(null!==d)s=D(l,d,n,t);else{if(!0!==x.revertOnSpill||C)return void(C&&c&&c.removeChild(i));s=y,l=v}(null===s&&u||s!==i&&s!==Z(i))&&(b=s,l.insertBefore(i,s),E.emit("shadow",i,l,v))}else c&&c.removeChild(i)}function f(e){E.emit(e,i,w,v)}}function A(e,n){for(var t=n;t!==e&&Q(t)!==e;)t=Q(t);return t===j?null:t}function D(o,n,i,a){var e,l="horizontal"===x.direction;return n!==o?(e=n.getBoundingClientRect(),t(l?i>e.left+V(e)/2:a>e.top+J(e)/2)):function(){var e,n,t,r=o.children.length;for(e=0;e<r;e++){if(n=o.children[e],t=n.getBoundingClientRect(),l&&t.left+t.width/2>i)return n;if(!l&&t.top+t.height/2>a)return n}return null}();function t(e){return e?Z(n):n}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./classes":9,"contra/emitter":5,crossvent:6}],11:[function(e,n,t){var r;r="function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){setTimeout(e,0)},n.exports=r},{}],12:[function(e,n,t){"use strict";var i=e("atoa"),a=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","drop-model","remove-model"];n.exports=function(n,t,r){function o(e){return n.isElement(e)?n.element(e):e}a.forEach(function(n){t.drake.on(n,function(){var e=i(arguments).map(o);e.unshift(t.name+"."+n),r.$emit.apply(r,e)})})}},{atoa:3}],13:[function(e,n,t){"use strict";var u=e("dragula"),r="$$dragula",c=e("./replicate-events");n.exports=function(f){return[function(){return{add:a,find:l,options:function(e,n,t){var r=a(e,n,u(t));o(e,r.drake)},destroy:function(e,n){var t=i(e).bags,r=l(e,n),o=t.indexOf(r);t.splice(o,1),r.drake.destroy()},handleModels:o};function o(t,a){var l,u,c,s;a.registered||(a.on("remove",function(e,n){a.models&&(s=a.models[a.containers.indexOf(n)],t.$applyAsync(function(){s.splice(u,1),a.emit("remove-model",e,n)}))}),a.on("drag",function(e,n){u=d(l=e,n)}),a.on("drop",function(r,o,i){a.models&&(c=d(r,o),t.$applyAsync(function(){if(s=a.models[a.containers.indexOf(i)],o===i)s.splice(c,0,s.splice(u,1)[0]);else{var e=l===r,n=a.models[a.containers.indexOf(o)],t=e?s[u]:f.copy(s[u]);e&&s.splice(u,1),n.splice(c,0,t),o.removeChild(r)}a.emit("drop-model",r,o,i)}))}),a.registered=!0)}function i(e){var n=e[r];return n||(n=e[r]={bags:[]}),n}function d(e,n){return Array.prototype.indexOf.call(f.element(n).children(),e)}function a(e,n,t){var r=l(e,n);if(r)throw new Error('Bag named: "'+n+'" already exists in same angular scope.');return r={name:n,drake:t},i(e).bags.push(r),c(f,r,e),t.models&&o(e,t),r}function l(e,n){for(var t=i(e).bags,r=0;r<t.length;r++)if(t[r].name===n)return t[r]}}]}},{"./replicate-events":12,dragula:10}]},{},[1])(1)});